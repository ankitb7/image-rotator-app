{"version":3,"sources":["ImageEditor/ImageEditor.utils.js","ImageEditor/ImageFrame/ImageFrame.jsx","ImageEditor/Panel/components/Number.jsx","App.constants.js","ImageEditor/Panel/Panel.jsx","ImageEditor/ImageEditor.jsx","App.js","reportWebVitals.js","index.js"],"names":["transform","newX","newY","centerX","centerY","sin","cos","rotatedX","rotatedY","x","Math","round","y","isRotatedPointInBounds","newHeight","newWidth","getImageCanvasAndContext","image","canvas","document","createElement","context","getContext","width","height","rotate","originalImageData","angle","centerHeight","trunc","centerWidth","getImageCenter","abs","calculateNewDimensions","newImageData","Uint8ClampedArray","rgbaPixelWidth","i","transformedPosition","finalPosition","j","ImageData","from","ImageFrame","rotatedImage","finalImage","className","defaultProps","Number","setAngle","useState","sanitizedValue","setSanitizedValue","useEffect","type","pattern","placeholder","value","onInput","e","inputValue","target","validity","valid","window","Panel","setImage","imageDimensions","renderTime","rotateImage","accept","onChange","toFixed","onClick","ImageEditor","file","setFile","setRotatedImage","setImageDimensions","setRenderTime","useCallback","startTime","performance","now","radians","PI","rotatedImageData","console","log","putImageData","Image","src","toDataURL","alt","endTime","preventDefault","reader","FileReader","files","onloadend","result","img","onload","this","drawImage","imageData","getImageData","data","readAsDataURL","App","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"+RAOMA,EAAY,SAACC,EAAMC,EAAMC,EAASC,EAASC,EAAKC,GAElD,IAAMC,EAAYN,EAAOK,EAAQJ,EAAOG,EAClCG,EAAYP,EAAOI,EAAQH,EAAOI,EAGxC,MAAO,CAACG,EAAGC,KAAKC,MAAMJ,EAAWJ,GAAUS,EAAGF,KAAKC,MAAMH,EAAWJ,KAKlES,EAAyB,SAACC,EAAWC,EAAUd,EAAMC,GAA5B,OAAqCD,GAAQ,GAAKA,EAAOc,GAAYb,GAAQ,GAAKA,EAAOY,GAE3GE,EAA2B,SAACC,GACrC,IAAMC,EAASC,SAASC,cAAc,UAChCC,EAAUH,EAAOI,WAAW,MAGlC,OAFAJ,EAAOK,MAAQN,EAAMM,MACrBL,EAAOM,OAASP,EAAMO,OACf,CAACN,SAAQG,YAGPI,EAAS,SAACC,EAAmBF,EAAQD,EAAOI,GAYrD,IAXA,IAAMtB,EAAMK,KAAKL,IAAIsB,GACfrB,EAAMI,KAAKJ,IAAIqB,GAF0C,EAZ5C,SAACH,EAAQD,GAAT,MAAoB,CAACK,aAAclB,KAAKmB,MAAML,EAAO,GAAIM,YAAapB,KAAKmB,MAAMN,EAAM,IAetEQ,CAAeP,EAAQD,GAApDK,EAHwD,EAGxDA,aAAcE,EAH0C,EAG1CA,YAH0C,EA5BpC,SAACN,EAAQD,EAAOlB,EAAKC,GAChD,IAAMQ,EAAaJ,KAAKC,MAAMD,KAAKsB,IAAIR,EAASlB,GAAOI,KAAKsB,IAAIT,EAAQlB,IAGxE,MAAO,CAACU,SAFUL,KAAKC,MAAMD,KAAKsB,IAAIT,EAAQjB,GAAOI,KAAKsB,IAAIR,EAASnB,IAErDS,aA4BYmB,CAAuBV,EAAOC,EAAQnB,EAAKC,GAAlEQ,EAJwD,EAIxDA,UAAWC,EAJ6C,EAI7CA,SAEZmB,EAAe,IAAIC,kBAA8B,EAAXpB,EAAgBD,GAEtDsB,EAAyB,EAARb,EAEnBX,EAAI,EAECyB,EAAI,EAAGA,EAAID,EAAiBZ,EAAQa,GAAQ,EAAG,CACpD,IAAM5B,EAAIC,KAAKC,MAAO0B,EAAID,EAAkB,GAOtCE,EAAsBtC,EAJZS,EAAIqB,EACJlB,EAAIgB,EAGwCE,EAAaF,EAAcvB,EAAKC,GAO5F,GAJAgC,EAAoB7B,GAAKC,KAAKC,OAAOI,EAAWQ,GAAS,GACzDe,EAAoB1B,GAAKF,KAAKC,OAAOG,EAAYU,GAAU,GAGvDX,EAAuBC,EAAWC,EAAUuB,EAAoB7B,EAAG6B,EAAoB1B,GAEvF,IADA,IAAM2B,EAAyC,EAAxBD,EAAoB7B,EAAU6B,EAAoB1B,GAAgB,EAAXG,GACtEyB,EAAI,EAAGA,EAAI,EAAGA,IAClBN,EAAaK,EAAgBC,GAAKd,EAAkBW,EAAIG,GAI5DH,EAAID,IAAmB,GACvBxB,IAGR,OAAO,IAAI6B,UAAUN,kBAAkBO,KAAKR,GAAenB,EAAUD,IC9DnE6B,G,MAAa,SAAC,GAA2B,IAA1B1B,EAAyB,EAAzBA,MAAO2B,EAAkB,EAAlBA,aAClBC,EAAaD,GAA8B3B,EACjD,OAAO,qBAAK6B,UAAU,cAAf,SACFD,GAA0B,qBAAKC,UAAU,mBAAf,wCASnCH,EAAWI,aAAe,CACtB9B,MAAO,KACP2B,aAAc,MAGHD,QCjBTK,G,MAAS,SAAC,GAAgB,IAAfC,EAAc,EAAdA,SAAc,EACiBC,mBAAS,IAD1B,mBACpBC,EADoB,KACJC,EADI,KAU3B,OAFAC,qBAAU,kBAAMJ,EAASE,KAAiB,CAACA,IAGvC,uBAAOG,KAAK,OAAOC,QCfG,yDDgBhBC,YAAY,UAAUC,MAAON,EAC7BO,QAVY,SAACC,GACnB,IAAMC,EAAcD,EAAEE,OAAOC,SAASC,MAASC,OAAOhB,OAAOW,EAAEE,OAAOJ,OAASN,EAC/EC,EAAkBQ,QAgB1BZ,EAAOD,aAAe,CAClBE,SAAU,cAGCD,QExBTiB,EAAQ,SAAC,GAA+E,IAA9EC,EAA6E,EAA7EA,SAAUjD,EAAmE,EAAnEA,MAAO2B,EAA4D,EAA5DA,aAAcuB,EAA8C,EAA9CA,gBAAiBC,EAA6B,EAA7BA,WAAYC,EAAiB,EAAjBA,YAAiB,EAC/DnB,mBAAS,GADsD,mBAClFvB,EADkF,KAC3EsB,EAD2E,KAGzF,OACI,sBAAKH,UAAU,eAAf,UACI,uBAAOA,UAAU,YAAYQ,KAAK,OAC3BgB,OAAO,UAAUC,SAAUL,IACjCjD,GAAS,sBAAK6B,UAAU,eAAf,UACN,qBAAKA,UAAU,OAAf,8CACmCqB,EAAgB5C,MADnD,sBACsE4C,EAAgB3C,OADtF,eAGCoB,GAAgB,qBAAKE,UAAU,OAAf,uCACIsB,QADJ,IACIA,OADJ,EACIA,EAAYI,QAAQ,GADxB,QAGjB,8BACI,cAAC,EAAD,CAAQvB,SAAUA,IAClB,wBAAQwB,QAAS,kBAAMJ,EAAY1C,IAAnC,6BAgBpBsC,EAAMlB,aAAe,CACjBmB,SAAU,aACVjD,MAAO,KACP2B,aAAc,KACduB,gBAAiB,CAAC5C,MAAO,EAAGC,OAAQ,GACpC4C,WAAY,EACZC,YAAa,MAGFJ,QCmBAS,G,MA3DK,WAAO,IAAD,EACExB,mBAAS,MADX,mBACfyB,EADe,KACTC,EADS,OAEI1B,mBAAS,MAFb,mBAEfjC,EAFe,KAERiD,EAFQ,OAGkBhB,mBAAS,MAH3B,mBAGfN,EAHe,KAGDiC,EAHC,OAIwB3B,mBAAS,CAAC3B,MAAO,EAAGC,OAAQ,IAJpD,mBAIf2C,EAJe,KAIEW,EAJF,OAKc5B,mBAAS,GALvB,mBAKfkB,EALe,KAKHW,EALG,KAgChBV,EAAcW,uBAAY,SAACrD,GAC7B,IAAMsD,EAAYC,YAAYC,MACxBC,EAAUzD,GAASjB,KAAK2E,GAAK,KAC7BC,EAAmB7D,EAAOkD,EAAMR,EAAgB3C,OAAQ2C,EAAgB5C,MAAO6D,GACrFG,QAAQC,IAAI,mBAAoBF,GAJO,MAMbtE,EAAyBsE,GAA5CpE,EANgC,EAMhCA,OANgC,EAMxBG,QACPoE,aAAaH,EAAkB,EAAG,IAEvB,IAAII,OACVC,IAAMzE,EAAO0E,YAE1Bf,EAAgB,qBAAKc,IAAKzE,EAAO0E,YAAaC,IAAI,sBAClD,IAAMC,EAAUZ,YAAYC,MAC5BJ,EAAce,EAAUb,KACzB,CAACN,EAAMR,IAEV,OACI,sBAAKrB,UAAU,eAAf,UACI,cAAC,EAAD,CAAY7B,MAAOA,EAAO2B,aAAcA,IACxC,cAAC,EAAD,CAAOsB,SA7CK,SAAAP,GAChBA,EAAEoC,iBAEF,IAAIC,EAAS,IAAIC,WACbtB,EAAOhB,EAAEE,OAAOqC,MAAM,GAC1BrB,EAAgB,MAEhBmB,EAAOG,UAAY,WACXH,EAAOI,QACPlC,EAAS,qBAAKyB,IAAKK,EAAOI,OAAQP,IAAI,uBAG1C,IAAIQ,EAAM,IAAIX,MACdW,EAAIC,OAAS,WACTxB,EAAmB,CAACvD,MAAOgF,KAAKhF,MAAOC,OAAQ+E,KAAK/E,SADhC,IAEbH,EAAWL,EAAyBqF,GAApChF,QACPA,EAAQmF,UAAUH,EAAK,EAAG,GAC1B,IAAMI,EAAYpF,EAAQqF,aAAa,EAAG,EAAGL,EAAI9E,MAAO8E,EAAI7E,QAC5DoD,EAAQ6B,EAAUE,OAEtBN,EAAIV,IAAMK,EAAOI,QAErBJ,EAAOY,cAAcjC,IAuBa1D,MAAOA,EAC9BkD,gBAAiBA,EAAiBvB,aAAcA,EAChDwB,WAAYA,EAAYC,YAAaA,S,MChDzCwC,MARf,WACE,OACE,qBAAK/D,UAAU,MAAf,SACI,cAAC,EAAD,OCKOgE,EAZS,SAAAC,GAClBA,GAAeA,aAAuBC,UACxC,6BAAqBC,MAAK,YAAkD,IAA/CC,EAA8C,EAA9CA,OAAQC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQC,EAAsB,EAAtBA,OAAQC,EAAc,EAAdA,QAC3DJ,EAAOH,GACPI,EAAOJ,GACPK,EAAOL,GACPM,EAAON,GACPO,EAAQP,OCDdQ,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,EAAD,MAEFtG,SAASuG,eAAe,SAM1BZ,M","file":"static/js/main.a15c4228.chunk.js","sourcesContent":["const calculateNewDimensions = (height, width, sin, cos) => {\r\n    const newHeight  = Math.round(Math.abs(height * cos) + Math.abs(width * sin));\r\n    const newWidth  = Math.round(Math.abs(width * cos) + Math.abs(height * sin));\r\n\r\n    return {newWidth, newHeight};\r\n};\r\n\r\nconst transform = (newX, newY, centerX, centerY, sin, cos) => {\r\n    //Rotate x,y co-ordinates by provided angle on the center\r\n    const rotatedX = (newX * cos) - (newY * sin);\r\n    const rotatedY = (newX * sin) + (newY * cos);\r\n\r\n    //Add center co-ordinates to get actual x,y co-ordinates\r\n    return {x: Math.round(rotatedX + centerX), y:Â Math.round(rotatedY + centerY)};\r\n};\r\n\r\nconst getImageCenter = (height, width) => ({centerHeight: Math.trunc(height/2), centerWidth: Math.trunc(width/2)});\r\n\r\nconst isRotatedPointInBounds = (newHeight, newWidth, newX, newY) => newX >= 0 && newX < newWidth && newY >= 0 && newY < newHeight;\r\n\r\nexport const getImageCanvasAndContext = (image) => {\r\n    const canvas = document.createElement('canvas');\r\n    const context = canvas.getContext('2d');\r\n    canvas.width = image.width;\r\n    canvas.height = image.height;\r\n    return {canvas, context};\r\n};\r\n\r\nexport const rotate = (originalImageData, height, width, angle) => {\r\n    const sin = Math.sin(angle);\r\n    const cos = Math.cos(angle);\r\n    const {centerHeight, centerWidth} = getImageCenter(height, width);\r\n    const {newHeight, newWidth} = calculateNewDimensions(width, height, sin, cos);\r\n\r\n    const newImageData = new Uint8ClampedArray((newWidth * 4) * newHeight);\r\n\r\n    const rgbaPixelWidth = width * 4;\r\n\r\n    let y = 0;\r\n\r\n    for (let i = 0; i < rgbaPixelWidth * height; i = i + 4) {\r\n        const x = Math.round((i % rgbaPixelWidth) / 4);\r\n\r\n        //Get x, y co-ordinates with respect to original image center\r\n        let adjustedX = x - centerWidth;\r\n        let adjustedY = y - centerHeight;\r\n\r\n        //Apply transformations to the co-ordinates to rotate them by given angle\r\n        const transformedPosition = transform(adjustedX, adjustedY, centerWidth, centerHeight, sin, cos);\r\n\r\n        //Adjust co-ordinates according to new width, height (new center)\r\n        transformedPosition.x += Math.round((newWidth - width) / 2.0);\r\n        transformedPosition.y += Math.round((newHeight - height) / 2.0);\r\n\r\n        //If the rotated co-ordinates lie within new image dimensions store them in new image data\r\n        if (isRotatedPointInBounds(newHeight, newWidth, transformedPosition.x, transformedPosition.y)) {\r\n            const finalPosition = (transformedPosition.x * 4) + (transformedPosition.y * (newWidth * 4));\r\n            for(let j = 0; j < 4; j++) {\r\n                newImageData[finalPosition + j] = originalImageData[i + j];\r\n            }\r\n        }\r\n\r\n        if (i % rgbaPixelWidth === 0) {\r\n            y++;\r\n        }\r\n    }\r\n    return new ImageData(Uint8ClampedArray.from(newImageData), newWidth, newHeight);\r\n};","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport './ImageFrame.css';\r\n\r\nconst ImageFrame = ({image, rotatedImage}) => {\r\n    const finalImage = rotatedImage ? rotatedImage : image;\r\n    return <div className='image-frame'>\r\n        {finalImage ? finalImage : <div className=\"placeholder-text\">Please select an image</div>}\r\n    </div>\r\n};\r\n\r\nImageFrame.propTypes = {\r\n    image: PropTypes.any,\r\n    rotatedImage: PropTypes.any\r\n};\r\n\r\nImageFrame.defaultProps = {\r\n    image: null,\r\n    rotatedImage: null\r\n};\r\n\r\nexport default ImageFrame;","import React, {useState, useEffect} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport {DEGREE_PATTERN} from '../../../App.constants';\r\n\r\nconst Number = ({setAngle}) => {\r\n    const [sanitizedValue, setSanitizedValue] = useState('');\r\n\r\n    const onInputChange = (e) => {\r\n        const inputValue = (e.target.validity.valid) ? window.Number(e.target.value) : sanitizedValue;\r\n        setSanitizedValue(inputValue);\r\n    };\r\n\r\n    useEffect(() => setAngle(sanitizedValue), [sanitizedValue]);\r\n\r\n    return (\r\n        <input type='text' pattern={DEGREE_PATTERN}\r\n              placeholder='Degrees' value={sanitizedValue}\r\n              onInput={onInputChange}/>\r\n    );\r\n};\r\n\r\nNumber.propTypes = {\r\n    setAngle: PropTypes.func\r\n};\r\n\r\nNumber.defaultProps = {\r\n    setAngle: () => {}\r\n};\r\n\r\nexport default Number;","export const DEGREE_PATTERN = '([0-9]|[1-8][0-9]|9[0-9]|[12][0-9]{2}|3[0-5][0-9]|360)';","import React, {useState} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport './Panel.css';\r\nimport Number from './components/Number';\r\n\r\nconst Panel = ({setImage, image, rotatedImage, imageDimensions, renderTime, rotateImage}) => {\r\n    const [angle, setAngle] = useState(0);\r\n\r\n    return (\r\n        <div className='action-panel'>\r\n            <input className='fileInput' type='file'\r\n                   accept='image/*' onChange={setImage}/>\r\n            {image && <div className='rotate-panel'>\r\n                <div className='info'>\r\n                    {`Original Image Dimensions: ${imageDimensions.width}px width x ${imageDimensions.height}px height`}\r\n                </div>\r\n                {rotatedImage && <div className='info'>\r\n                    {`Render Time: ${renderTime?.toFixed(2)}ms`}\r\n                </div>}\r\n                <p>\r\n                    <Number setAngle={setAngle}/>\r\n                    <button onClick={() => rotateImage(angle)}>Apply</button>\r\n                </p>\r\n            </div>}\r\n        </div>\r\n    );\r\n};\r\n\r\nPanel.propTypes = {\r\n    setImage: PropTypes.func,\r\n    image: PropTypes.any,\r\n    imageDimensions: PropTypes.shape({}),\r\n    rotatedImage: PropTypes.any,\r\n    renderTime: PropTypes.number,\r\n    onChange1: PropTypes.func,\r\n};\r\n\r\nPanel.defaultProps = {\r\n    setImage: () => {},\r\n    image: null,\r\n    rotatedImage: null,\r\n    imageDimensions: {width: 0, height: 0},\r\n    renderTime: 0,\r\n    rotateImage: null\r\n};\r\n\r\nexport default Panel;","import React, {useState, useCallback} from 'react';\r\nimport {getImageCanvasAndContext, rotate} from './ImageEditor.utils';\r\nimport ImageFrame from './ImageFrame/ImageFrame';\r\nimport Panel from './Panel/Panel';\r\nimport './ImageEditor.css';\r\n\r\nconst ImageEditor = () => {\r\n    const [file, setFile] = useState(null);\r\n    const [image, setImage] = useState(null);\r\n    const [rotatedImage, setRotatedImage] = useState(null);\r\n    const [imageDimensions, setImageDimensions] = useState({width: 0, height: 0});\r\n    const [renderTime, setRenderTime] = useState(0);\r\n\r\n    const changeImage = e => {\r\n        e.preventDefault();\r\n\r\n        let reader = new FileReader();\r\n        let file = e.target.files[0];\r\n        setRotatedImage(null);\r\n\r\n        reader.onloadend = () => {\r\n            if (reader.result) {\r\n                setImage(<img src={reader.result} alt='Original Document'/>);\r\n            }\r\n\r\n            let img = new Image();\r\n            img.onload = function() {\r\n                setImageDimensions({width: this.width, height: this.height});\r\n                const {context} = getImageCanvasAndContext(img);\r\n                context.drawImage(img, 0, 0 );\r\n                const imageData = context.getImageData(0, 0, img.width, img.height);\r\n                setFile(imageData.data);\r\n            };\r\n            img.src = reader.result;\r\n        };\r\n        reader.readAsDataURL(file);\r\n    };\r\n\r\n    const rotateImage = useCallback((angle) => {\r\n        const startTime = performance.now();\r\n        const radians = angle * (Math.PI / 180);\r\n        const rotatedImageData = rotate(file, imageDimensions.height, imageDimensions.width, radians);\r\n        console.log('rotatedImageData', rotatedImageData);\r\n\r\n        const {canvas, context} = getImageCanvasAndContext(rotatedImageData);\r\n        context.putImageData(rotatedImageData, 0, 0);\r\n\r\n        let rotatedImage = new Image();\r\n        rotatedImage.src = canvas.toDataURL();\r\n\r\n        setRotatedImage(<img src={canvas.toDataURL()} alt='Rotated Document'/>);\r\n        const endTime = performance.now();\r\n        setRenderTime(endTime - startTime);\r\n    }, [file, imageDimensions]);\r\n\r\n    return (\r\n        <div className='image-editor'>\r\n            <ImageFrame image={image} rotatedImage={rotatedImage}/>\r\n            <Panel setImage={changeImage} image={image}\r\n                   imageDimensions={imageDimensions} rotatedImage={rotatedImage}\r\n                   renderTime={renderTime} rotateImage={rotateImage}/>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default ImageEditor;","import React from 'react';\nimport ImageEditor from './ImageEditor/ImageEditor'\nimport './App.css';\n\nfunction App() {\n  return (\n    <div className='App'>\n        <ImageEditor/>\n    </div>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}