{"version":3,"sources":["ImageEditor/ImageEditor.utils.js","ImageEditor/ImageFrame/ImageFrame.jsx","ImageEditor/Panel/components/Number.jsx","App.constants.js","ImageEditor/Panel/Panel.jsx","ImageEditor/ImageEditor.jsx","App.js","reportWebVitals.js","index.js"],"names":["transform","newX","newY","centerX","centerY","sin","cos","tan","rotatedX","Math","round","rotatedY","x","y","isRotatedPointInBounds","newHeight","newWidth","rotate","imageData","angle","originalImageData","height","width","radians","PI","centerHeight","trunc","centerWidth","getImageCenter","abs","calculateNewDimensions","newImageData","Uint8ClampedArray","adjustedWidth","i","transformedPosition","finalPosition","j","ImageFrame","image","rotatedImage","finalImage","className","defaultProps","Number","setAngle","useState","sanitizedValue","setSanitizedValue","useEffect","type","pattern","placeholder","value","onInput","e","inputValue","target","validity","valid","window","Panel","changeImage","imageDimensions","renderTime","rotateImage","accept","onChange","toFixed","onClick","ImageEditor","file","setFile","setImage","setRotatedImage","setImageDimensions","setRenderTime","getImageCanvasAndContext","canvas","document","createElement","context","getContext","useCallback","startTime","performance","now","rotatedImageArray","rotatedImageData","ImageData","from","putImageData","Image","src","toDataURL","alt","endTime","preventDefault","reader","FileReader","files","onloadend","result","img","onload","this","drawImage","getImageData","data","readAsDataURL","App","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.06e82f7f.chunk.js","sourcesContent":["export const calculateNewDimensions = (height, width, sin, cos) => {\r\n    const newHeight  = Math.round(Math.abs(height * cos) + Math.abs(width * sin));\r\n    const newWidth  = Math.round(Math.abs(width * cos) + Math.abs(height * sin));\r\n\r\n    return {newWidth, newHeight};\r\n};\r\n\r\n//Transform method uses 3 shear technique to rotate image without aliasing\r\nexport const transform = (newX, newY, centerX, centerY, sin, cos, tan) => {\r\n    //First shear\r\n    let rotatedX = Math.round(newX - (newY * tan));\r\n    let rotatedY = newY;\r\n\r\n    //Second shear\r\n    rotatedY = Math.round((rotatedX * sin) + rotatedY);\r\n\r\n    //Third shear\r\n    rotatedX = Math.round(rotatedX - (rotatedY * tan));\r\n\r\n    //Add center co-ordinates to get actual x,y co-ordinates\r\n    return {x: Math.round(rotatedX + centerX), y:Â Math.round(rotatedY + centerY)};\r\n};\r\n\r\nexport const getImageCenter = (height, width) => ({centerHeight: Math.trunc(height/2), centerWidth: Math.trunc(width/2)});\r\n\r\nexport const isRotatedPointInBounds = (newHeight, newWidth, newX, newY) => newX >= 0 && newX < newWidth && newY >= 0 && newY < newHeight;\r\n\r\nexport const rotate = (imageData, angle) => {\r\n    const {originalImageData, height, width} = imageData;\r\n    const radians = angle * (Math.PI / 180);\r\n\r\n    const sin = Math.sin(radians);\r\n    const cos = Math.cos(radians);\r\n    const tan = Math.tan(radians/2);\r\n\r\n    const {centerHeight, centerWidth} = getImageCenter(height, width);\r\n\r\n    const {newHeight, newWidth} = calculateNewDimensions(width, height, sin, cos);\r\n\r\n    const newImageData = new Uint8ClampedArray((newWidth * 4) * newHeight);\r\n\r\n    const adjustedWidth = width * 4;\r\n\r\n    let y = 0;\r\n\r\n    for (let i = 0; i < adjustedWidth * height; i = i + 4) {\r\n        const x = Math.round((i % adjustedWidth) / 4);\r\n\r\n        //Get x, y co-ordinates with respect to original image center\r\n        let adjustedX = x - centerWidth;\r\n        let adjustedY = y - centerHeight;\r\n\r\n        //Apply transformations to the co-ordinates to rotate them by given angle\r\n        const transformedPosition = transform(adjustedX, adjustedY, centerWidth, centerHeight, sin, cos, tan);\r\n\r\n        //Adjust co-ordinates according to new width, height (new center)\r\n        transformedPosition.x += Math.round((newWidth - width) / 2.0);\r\n        transformedPosition.y += Math.round((newHeight - height) / 2.0);\r\n\r\n        //If the rotated co-ordinates lie within new image dimensions store them in new image data\r\n        if (isRotatedPointInBounds(newHeight, newWidth, transformedPosition.x, transformedPosition.y)) {\r\n            const finalPosition = (transformedPosition.x * 4) + (transformedPosition.y * (newWidth * 4));\r\n            for(let j = 0; j < 4; j++) {\r\n                newImageData[finalPosition + j] = originalImageData[i + j];\r\n            }\r\n        }\r\n\r\n        if (i % adjustedWidth === 0) {\r\n            y++;\r\n        }\r\n    }\r\n    return {newImageData, newWidth, newHeight};\r\n};","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport './ImageFrame.css';\r\n\r\nconst ImageFrame = ({image, rotatedImage}) => {\r\n    const finalImage = rotatedImage ? rotatedImage : image;\r\n    return (\r\n        <div className='image-frame'>\r\n            {finalImage ? finalImage : <div className='placeholder-text'>Please select an image</div>}\r\n        </div>\r\n    );\r\n};\r\n\r\nImageFrame.propTypes = {\r\n    image: PropTypes.any,\r\n    rotatedImage: PropTypes.any\r\n};\r\n\r\nImageFrame.defaultProps = {\r\n    image: null,\r\n    rotatedImage: null\r\n};\r\n\r\nexport default ImageFrame;","import React, {useState, useEffect} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport {DEGREE_PATTERN} from '../../../App.constants';\r\n\r\nconst Number = ({setAngle}) => {\r\n    const [sanitizedValue, setSanitizedValue] = useState(0);\r\n\r\n    const onInputChange = (e) => {\r\n        const inputValue = (e.target.validity.valid) ? window.Number(e.target.value) : sanitizedValue;\r\n        setSanitizedValue(inputValue);\r\n    };\r\n\r\n    useEffect(() => setAngle(sanitizedValue), [setAngle, sanitizedValue]);\r\n\r\n    return (\r\n        <input type='text' pattern={DEGREE_PATTERN}\r\n              placeholder='Degrees' value={sanitizedValue}\r\n              onInput={onInputChange}/>\r\n    );\r\n};\r\n\r\nNumber.propTypes = {\r\n    setAngle: PropTypes.func\r\n};\r\n\r\nNumber.defaultProps = {\r\n    setAngle: () => {}\r\n};\r\n\r\nexport default Number;","export const DEGREE_PATTERN = '([0-9]|[1-8][0-9]|9[0-9]|[12][0-9]{2}|3[0-5][0-9]|360)';","import React, {useState} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport Number from './components/Number';\r\nimport './Panel.css';\r\n\r\nconst Panel = ({changeImage, image, rotatedImage, imageDimensions, renderTime, rotateImage}) => {\r\n    const [angle, setAngle] = useState(0);\r\n\r\n    return (\r\n        <div className='action-panel'>\r\n            <div className='panel-header'>Editor Panel</div>\r\n            <input className='file-input' type='file'\r\n                   accept='image/*' onChange={changeImage}/>\r\n            {image && <div className='rotate-panel'>\r\n                <div className='info'>\r\n                    {`Original Image Dimensions: ${imageDimensions.width}px width x ${imageDimensions.height}px height`}\r\n                </div>\r\n                {rotatedImage && <div className='info'>\r\n                    {`Render Time: ${renderTime?.toFixed(2)}ms`}\r\n                </div>}\r\n                <p>\r\n                    <Number setAngle={setAngle}/>\r\n                    <button onClick={() => rotateImage(angle)}>Apply</button>\r\n                </p>\r\n            </div>}\r\n        </div>\r\n    );\r\n};\r\n\r\nPanel.propTypes = {\r\n    changeImage: PropTypes.func,\r\n    image: PropTypes.any,\r\n    imageDimensions: PropTypes.shape({}),\r\n    rotatedImage: PropTypes.any,\r\n    renderTime: PropTypes.number,\r\n    onChange1: PropTypes.func,\r\n};\r\n\r\nPanel.defaultProps = {\r\n    changeImage: () => {},\r\n    image: null,\r\n    rotatedImage: null,\r\n    imageDimensions: {width: 0, height: 0},\r\n    renderTime: 0,\r\n    rotateImage: null\r\n};\r\n\r\nexport default Panel;","import React, {useState, useCallback} from 'react';\r\nimport {rotate} from './ImageEditor.utils';\r\nimport ImageFrame from './ImageFrame/ImageFrame';\r\nimport Panel from './Panel/Panel';\r\nimport './ImageEditor.css';\r\n\r\nconst ImageEditor = () => {\r\n    const [file, setFile] = useState(null);\r\n    const [image, setImage] = useState(null);\r\n    const [rotatedImage, setRotatedImage] = useState(null);\r\n    const [imageDimensions, setImageDimensions] = useState({width: 0, height: 0});\r\n    const [renderTime, setRenderTime] = useState(0);\r\n\r\n    const changeImage = e => {\r\n        e.preventDefault();\r\n\r\n        let reader = new FileReader();\r\n        let file = e.target.files[0];\r\n\r\n        //Clear out the rotated image each time a new image is set\r\n        setRotatedImage(null);\r\n\r\n        reader.onloadend = () => {\r\n            if (reader.result) {\r\n                setImage(<img src={reader.result} alt='Original Document'/>);\r\n            }\r\n\r\n            let img = new Image();\r\n            img.onload = function() {\r\n                setImageDimensions({width: this.width, height: this.height});\r\n\r\n                const {context} = getImageCanvasAndContext(img);\r\n                context.drawImage(img, 0, 0 );\r\n                const imageData = context.getImageData(0, 0, img.width, img.height);\r\n\r\n                setFile(imageData.data);\r\n            };\r\n            img.src = reader.result;\r\n        };\r\n        reader.readAsDataURL(file);\r\n    };\r\n\r\n    const getImageCanvasAndContext = (image) => {\r\n        const canvas = document.createElement('canvas');\r\n        const context = canvas.getContext('2d');\r\n        canvas.width = image.width;\r\n        canvas.height = image.height;\r\n        return {canvas, context};\r\n    };\r\n\r\n    const rotateImage = useCallback((angle) => {\r\n        const startTime = performance.now();\r\n\r\n        const rotatedImageArray = rotate({originalImageData: file, height: imageDimensions.height, width: imageDimensions.width}, angle);\r\n        const {newImageData, newWidth, newHeight} = rotatedImageArray;\r\n        const rotatedImageData = new ImageData(Uint8ClampedArray.from(newImageData), newWidth, newHeight);\r\n\r\n        const {canvas, context} = getImageCanvasAndContext(rotatedImageData);\r\n        context.putImageData(rotatedImageData, 0, 0);\r\n\r\n        let rotatedImage = new Image();\r\n        rotatedImage.src = canvas.toDataURL();\r\n\r\n        setRotatedImage(<img src={canvas.toDataURL()} alt='Rotated Document'/>);\r\n\r\n        const endTime = performance.now();\r\n        setRenderTime(endTime - startTime);\r\n    }, [file, imageDimensions]);\r\n\r\n    return (\r\n        <div className='main-container'>\r\n            <header className='page-header'>\r\n                Image Rotator Application\r\n            </header>\r\n            <div className='page-content'>\r\n                <div className='sidebar-left'>\r\n                    <Panel changeImage={changeImage} image={image}\r\n                           imageDimensions={imageDimensions} rotatedImage={rotatedImage}\r\n                           renderTime={renderTime} rotateImage={rotateImage}/>\r\n                </div>\r\n                <div className='content-container'>\r\n                    <ImageFrame image={image} rotatedImage={rotatedImage}/>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default ImageEditor;","import React from 'react';\nimport ImageEditor from './ImageEditor/ImageEditor'\nimport './App.css';\n\nfunction App() {\n  return (\n    <div className='app'>\n        <ImageEditor/>\n    </div>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}